# PBR Texture Set Importer for Blender

A Blender addon that automatically imports PBR texture sets generated by the tessellating-pbr-generator, creating properly configured Principled BSDF materials.

## Features

- **Automatic Texture Detection**: Recognizes common PBR texture naming conventions
- **Smart Material Setup**: Creates Principled BSDF materials with proper node connections
- **Color Space Management**: Automatically sets correct color spaces (sRGB for diffuse, Non-Color for others)
- **Ambient Occlusion Mixing**: Optional mixing of AO with diffuse/albedo
- **Displacement Support**: Configurable displacement/height map with scale control
- **Batch Import**: Import entire PBR texture sets with one click

## Requirements

- Blender 3.0 or higher
- PBR texture sets with consistent naming conventions

## Installation

1. **Download the addon**:
   ```bash
   # If you have the repository cloned:
   cd tessellating-pbr-generator/blender
   ```

2. **Install in Blender**:
   - Open Blender
   - Go to Edit → Preferences → Add-ons
   - Click "Install..." button
   - Navigate to `pbr_importer.py` and select it
   - Enable the addon by checking the box next to "Import-Export: PBR Texture Set Importer"

3. **Alternative: Manual Installation**:
   - Copy `pbr_importer.py` to your Blender addons folder:
     - Windows: `%APPDATA%\Blender Foundation\Blender\[version]\scripts\addons\`
     - macOS: `/Users/[user]/Library/Application Support/Blender/[version]/scripts/addons/`
     - Linux: `~/.config/blender/[version]/scripts/addons/`

## Usage

### Basic Import

1. **Select Objects** (optional):
   - Select the objects you want to apply the material to
   - If no objects are selected, the material will just be created

2. **Import PBR Set**:
   - Go to File → Import → PBR Texture Set
   - Navigate to the folder containing your PBR textures
   - Click "Import PBR Texture Set"

3. **Configure Options**:
   - **Create New Material**: Creates a new material even if one exists with the same name
   - **Apply to Selected Objects**: Automatically applies the material to selected objects
   - **Displacement Scale**: Controls the strength of displacement (0.0 - 1.0)
   - **AO Mix Factor**: Controls how much AO is mixed with diffuse (0.0 - 1.0)

### Texture Naming Conventions

The addon recognizes these texture naming patterns:

| Texture Type | Recognized Keywords |
|-------------|-------------------|
| **Diffuse/Albedo** | diffuse, albedo, color, basecolor |
| **Normal** | normal, norm, nrm |
| **Roughness** | roughness, rough, rgh |
| **Metallic** | metallic, metal, met |
| **Height/Displacement** | height, displacement, disp, bump |
| **Ambient Occlusion** | ao, ambient_occlusion, occlusion, occ |

### Example Filenames

The addon will correctly identify textures with names like:
- `stone_diffuse_1024x1024.png`
- `stone_normal_1024x1024.png`
- `stone_roughness_1024x1024.png`
- `stone_metallic_1024x1024.png`
- `stone_height_1024x1024.png`
- `stone_ao_1024x1024.png`

## Material Setup Details

The addon creates a node setup with the following connections:

### Node Tree Structure

```
[Diffuse Texture] ─┐
                   ├─→ [Mix RGB (Multiply)] ─→ [Principled BSDF] → Base Color
[AO Texture] ──────┘

[Normal Texture] ─→ [Normal Map] ─→ [Principled BSDF] → Normal

[Roughness Texture] ─→ [Principled BSDF] → Roughness

[Metallic Texture] ─→ [Principled BSDF] → Metallic

[Height Texture] ─→ [Displacement] ─→ [Material Output] → Displacement
```

### Color Space Settings

- **Diffuse/Albedo**: sRGB (for color data)
- **All Other Maps**: Non-Color (for data textures)

## Advanced Usage

### Python API

You can also use the addon programmatically:

```python
import bpy

# Import a PBR texture set
bpy.ops.import_texture.pbr_set(
    filepath="/path/to/texture/folder/",
    create_new_material=True,
    apply_to_selected=True,
    displacement_scale=0.1,
    ao_mix_factor=0.5
)
```

### Customization

To customize the addon for your workflow:

1. **Modify texture keywords**: Edit the `texture_types` dictionary in `find_texture_files()`
2. **Adjust default values**: Change the default values for `displacement_scale` and `ao_mix_factor`
3. **Add custom node setups**: Extend the `create_material()` method

## Troubleshooting

### Common Issues

1. **"No texture files found"**
   - Ensure your textures follow the naming conventions
   - Check that you're selecting a folder, not a file
   - Verify the textures are in a supported format (PNG, JPG, TIFF, EXR)

2. **Materials look incorrect**
   - Check that Normal Map node strength is set to 1.0
   - Verify color spaces are set correctly
   - Ensure your viewport shading is set to "Material Preview" or "Rendered"

3. **Displacement not visible**
   - Enable displacement in the material settings
   - Increase subdivision levels on your mesh
   - Adjust the displacement scale value

### Debug Mode

To enable debug output, run Blender from the terminal/command line and check the console for messages.

## Integration with tessellating-pbr-generator

This addon is designed to work seamlessly with textures generated by the tessellating-pbr-generator:

1. **Generate textures**:
   ```bash
   python main.py generate stone --size 1024
   ```

2. **Import in Blender**:
   - File → Import → PBR Texture Set
   - Navigate to `output/stone/`
   - Import with default settings

3. **Apply to objects**:
   - The material is automatically applied to selected objects
   - Use the Shader Editor to fine-tune the material

## Version History

- **v1.0.0** (2024-01-24)
  - Initial release
  - Automatic texture detection and import
  - Principled BSDF material setup
  - AO mixing and displacement support

## License

This addon is part of the tessellating-pbr-generator project and follows the same license terms.

## Support

For issues or feature requests, please visit:
- GitHub: [tessellating-pbr-generator](https://github.com/yourusername/tessellating-pbr-generator)
- Issues: [GitHub Issues](https://github.com/yourusername/tessellating-pbr-generator/issues)